### Deep Malware Behavioral Analysis: 532d4b1d8aa6b3e90176927c2597f28c7173f9293304504f9c3a426c821c93d
- **Key Behavioral Findings**: The malware, disguised as an installer for "Ninja Browser," establishes persistent, high-privileged execution through the creation of scheduled tasks (`schtasks.exe`) set to run `ONLOGON` with `HIGHEST` privileges. It also modifies `Active Setup` registry keys for persistence. The malware executes scripts from temporary directories using `mshta.exe`, a known Living-off-the-Land (LOLBin) technique for defense evasion. A critical finding is the loading of `RstrtMgr.dll`, a library commonly abused by ransomware and wipers to terminate processes that lock files, enabling subsequent encryption or deletion.
- **Suspicious Activity**: 
    - **Persistence:** Creates scheduled tasks named "NinjaBrowserUpdate" and "NinjaBrowserUpdateLog" to run an `updater.exe` with the highest privileges at user logon. Modifies `HKLM\\SOFTWARE\\...\\Active Setup\\Installed Components` registry keys to configure a Run Once task.
    - **Execution from Temp Folder:** Executes `.hta` files (`SetUserFTA_delete.hta`, `SetUserFTA_write.hta`) from a temporary directory (`AppData\\Local\\Temp\\...`) using `mshta.exe`. This is a common method to bypass application controls.
    - **Payload Delivery:** Makes outbound connections to `d.ninja-browser.com` to download additional executable files, including `NinjaBrowser.exe` and `mini_installer.exe`.
    - **Suspicious DLL Load:** Loads `Rstrtmgr.dll`, which strongly indicates a capability to forcibly unlock files, a technique primarily associated with ransomware and wipers.
- **Threat Classification**:  **Trojan Downloader / Adware with potential Ransomware/Wiper payload.** While presenting as an adware installer (Ninja Browser), its underlying behavior—establishing high-privilege persistence, downloading and executing further payloads, and loading DLLs associated with destructive malware—classifies it as a malicious trojan. The initial triage label of `trojan.ninjasor` is consistent with these findings.
- **Infrastructure Indicators**: 
    - **Primary C2 Domain:** `d.ninja-browser.com`
    - **Associated C2 URLs:** `https://d.ninja-browser.com/bin/NinjaBrowser.exe`, `https://d.ninja-browser.com/bin/version.txt`, `https://d.ninja-browser.com/bin/mini_installer.exe`
    - **Suspicious Domain:** `malware-filter.pages.dev`
- **Attack Chain Analysis**:  The attack begins with the execution of a deceptive installer package (`setup.exe`). This installer drops files into temporary locations and immediately establishes persistence using scheduled tasks and registry modifications. It then uses `mshta.exe` to execute malicious HTA scripts for its primary operations. The malware communicates with its C2 server (`d.ninja-browser.com`) to download the next stage of the attack. The presence of `RstrtMgr.dll` suggests the final payload may be ransomware or a wiper.
- **Contextual Insights**: The file is signed with a certificate issued to "OOO MAKTE," which may be a compromised or fraudulent entity. The use of an Inno Setup installer is common for bundling legitimate software with adware or malware. The combination of techniques suggests an organized threat, not just a simple Potentially Unwanted Program (PUP).
-----
**Verdict:** **Malicious**
**Justification:** The file exhibits multiple high-confidence malicious behaviors, including establishing high-privilege persistence via scheduled tasks, using LOLBins (`mshta.exe`) for execution from temporary folders, and communicating with a C2 server to download additional payloads. The loading of `RstrtMgr.dll` is a significant indicator of potential ransomware or wiper functionality, elevating the threat level considerably beyond simple adware.
**Recommended Action:** **Hand off to Adversary Infra Hunting Agent**